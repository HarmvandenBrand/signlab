<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<title>Interface ZonMW COVID 19 Project</title>

<meta http-equiv="Access-Control-Allow-Origin" content="*">
<meta http-equiv="Access-Control-Allow-Methods" content="GET">
<!-- <meta http-equiv="Access-Control-Allow-Methods" content="POST"> -->

<!-- CWA @ vhg.cmp.uea.ac.uk/jrwg/ -->
<link rel="stylesheet" href="static/cwasa.css">
<script type="text/javascript"
    src="static/allcsa.js"></script>

<script language="javascript">

function playURL(surl) {
	CWASA.playSiGMLURL(surl);
}

function playText(stext) {
	CWASA.playSiGMLText(stext);
}

function addStatus(evt) {
	var elt = document.getElementById("myStatusLog");
	var msg = evt.msg;
	if (evt.av != "*") {
		msg = "[av" + evt.av + "] " + msg;
	}
	elt.value = elt.value + msg + "\n";
}
CWASA.addHook("status", addStatus);

var lggr = CWASA.getLogger("CWASA", "trace");

function setFPS(evt) {
	var elt = document.getElementById("myFPS");
	elt.value = evt.msg.toFixed(2);
}
CWASA.addHook("avatarfps", setFPS, 0);

function setSignFrame(evt) {
	var msg = evt.msg;
	var elt = document.getElementById("mySF");
	elt.value = (msg.s+1)+"/"+(msg.f+1);
	elt = document.getElementById("myGloss");
	elt.value = msg.g;
}
CWASA.addHook("avatarsign", setSignFrame, 0);

</script>

<!-- <script src="http://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script> -->
<script type="text/javascript" src="../static/jquery-3.5.1.min.js"></script>

<script>
// let scrapeJSON = 'http://bluegalaxy.info/cgi/scrapeJSON.py'
var options = "";
function goPython(text){
    $.ajax({
      method: "POST",
      url: "main.py",
      data: JSON.stringify({"param": text}),
      contentType: "application/json;charset=UTF-8",
      beforeSend: function() {
        alert(text);
      },
      success: function(response) {
        playURL(response);
        alert("It worked " + response);
      },
      error: function() {
        alert('Something went wrong');
        },
     });
}

function suggestions(text){
  $.ajax({
      method: "POST",
      url: "/suggestions",
      data: JSON.stringify({"param": text}),
      contentType: "application/json;charset=UTF-8",
      // beforeSend: function() {
      //   alert("input: " + text);
      // },
      // success: function(response) {
      //   options = response.split(",");
      //   alert("options: " + options);
      // },
      // error: function (qXHR, error, errorThrown ) {
      //   console.log(error);
      // },
  });
}



/*execute a function when someone clicks in the document:*/
// document.addEventListener("click", function (e) {
//     closeAllLists(e.target);
// });
//   // $.get(scrapeJSON, function(data) {
  //    // Get JSON data from Python script
  //    if (data){
  //       console.log("Data returned:", data)
  //    }
  //    jobDataJSON = JSON.parse(data)
  // }

  </script>

<!-- <script type="text/javascript"
    src="https://cdn.jsdelivr.net/npm/brython@3.8.9/brython.min.js">
</script>

<script type="text/javascript"
    src="https://cdn.jsdelivr.net/npm/brython@3.8.9/brython_stdlib.js">
</script> -->

<script src="static/brython.js"></script>
<script src="static/brython_stdlib.js"></script>


</head>

<!-- <body onload="CWASA.init(); brython(1);"> -->
<body onload="brython(1);">


<!--================================================================-->
<h3>Interface ZonMW COVID-19 Project</h3>



<!-- CWA signing avatar panel 0 -->
<!--================================================================-->
<!-- <div class="CWASAPanel av0" align="center" ></div> -->
<div class="CWASAAvatar av0" align="center" ></div>
<!--================================================================-->


<div align="center">
Enter Sentence:<br><!-- 
<textarea id="mySiGML" class="txtaSiGMLText" rows="6" oninput="suggestions(this.value)"> -->
<textarea id="mySiGML" class="txtaSiGMLText" rows="6">
</textarea>

<div id="suggestions" class="suggestions" style="text-align:center;"></div>

<br>
<!-- <input type="button" id = "play" value="Play" onclick='goPython(document.getElementById("mySiGML").value);' /> -->
<input type="button" id = "play" value="Play"/>
<input type="button" value="Stop" onclick='CWASA.stopSiGML();' />
<br>
<br>
Adjust speed: <span class="CWASASpeed av0"></span>
</div>
<script type="text/python">
from browser import document
from browser.widgets.dialog import InfoDialog

def click(ev):
    InfoDialog("Hello, Hey", f"Hello, {document['mySiGML'].value} !")

# bind event 'click' on button to function echo
document["play"].bind("click", click)
</script>
<script type="text/python" src="test.py"></script>
<button id="echo">click !</button>

<!-- New URL:  <input type="button" value="doURL" onclick='playURL(document.getElementById("myURL").value);' /><br>
<input id="myURL" class="txtSiGMLURL av0" value="welkom-ngt.sigml" type="text" />
<br>
 -->
<!-- <hr/> -->
<!-- <p align="center">
<span class="CWASAProgress av0"></span>
 -->

<!-- FR: I've made the following progress fields invisible, if you comment them out completely the avatar doesn't work anymore -->
<div align="center" class="undisplayed">
<span style="font-size: 90%;" >
Sign/Frame:
<input id="mySF" class="txtSF" value="0/0" type="text" />
&nbsp;
Gloss:
<input id="myGloss" class="txtGloss" value="[none]" type="text" />
&nbsp;
FPS:
<input id="myFPS" class="txtFPS" value="00.00" type="text" />
</span>
</div>


<div align="center">
  <!-- FR: I've made the following status log field invisible, if you comment it out completely the avatar doesn't work anymore -->
<textarea id="myStatusLog"  class="statusLog undisplayed" rows="6">
</textarea>
</div>

<br>


<!-- SToCA applet element panel -->
<!--================================================================-->
<div class="SToCA" align="center" ></div>
<!--================================================================-->

</body>
</html>
