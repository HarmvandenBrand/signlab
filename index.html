<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<title>Interface ZonMW COVID 19 Project</title>

<meta http-equiv="Access-Control-Allow-Origin" content="*">
<meta http-equiv="Access-Control-Allow-Methods" content="GET">

<!-- CWA @ vhg.cmp.uea.ac.uk/jrwg/ -->
<link rel="stylesheet" href="static/cwasa.css">
<script type="text/javascript"
    src="cwa/allcsa.js"></script>

<link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/smoothness/jquery-ui.css"></link>
<script type="text/javascript" src="../static/jquery-3.5.1.min.js"></script>
<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>

<script language="javascript">

function playURL(surl) {
	CWASA.playSiGMLURL(surl);
}

function playText(stext) {
	CWASA.playSiGMLText(stext);
}

function addStatus(evt) {
	var elt = document.getElementById("myStatusLog");
	var msg = evt.msg;
	if (evt.av != "*") {
		msg = "[av" + evt.av + "] " + msg;
	}
	elt.value = elt.value + msg + "\n";
}
CWASA.addHook("status", addStatus);

var lggr = CWASA.getLogger("CWASA", "trace");

function setFPS(evt) {
	var elt = document.getElementById("myFPS");
	elt.value = evt.msg.toFixed(2);
}
CWASA.addHook("avatarfps", setFPS, 0);

function setSignFrame(evt) {
	var msg = evt.msg;
	var elt = document.getElementById("mySF");
	elt.value = (msg.s+1)+"/"+(msg.f+1);
	elt = document.getElementById("myGloss");
	elt.value = msg.g;
}
CWASA.addHook("avatarsign", setSignFrame, 0);

</script>


<script>
// let scrapeJSON = 'http://bluegalaxy.info/cgi/scrapeJSON.py'

// Defines the functions and variable necessary for autcomplete suggestions
$( function() {

  // Defines all the options for autocomplete suggestions
  var options = ["Goedemorgen","Goedemiddag","Goedenavond","Tot ziens","Tot morgen","Heeft U goed geslapen?","Welterusten","Eet smakelijk","Ik kom op een later moment terug.","Ik moet even weg.","Sorry, ik heb geen tijd.","Ik ga u een nieuw infuus geven.","De arts gaat u een nieuw infuus geven.","De verpleegkundige gaat u een nieuw infuus geven.","Een laborant komt bloedprikken (Voor Avatar: een laborant komt in de ochtend/ middag bloedprikken).","Een co- assistent (student in opleiding tot arts) komt bloedprikken.","Een collega komt bloedprikken.","Sorry, het lukt mij niet het infuus te prikken. Ik ga een collega vragen.","De MRI is goed.","De bloeduitslagen zijn goed.","De bloeduitslagen zijn niet helemaal goed.","De uitslag van de CT scan is goed.","De uitslag van de CT scan is niet helemaal goed.","De röntgenfoto is verbeterd.","De röntgenfoto is verslechterd.","De röntgenfoto is hetzelfde gebleven.","Heeft u pijn?","Op een schaal van 0-10, waarbij 0 ‘geen pijn’ is en 10 de meeste pijn die u zich kunt voor stellen, hoeveel pijn heeft u?","Waar heeft U pijn?","Wat voor soort pijn heeft U? Drukkend, stekend, krampend of anders omschrijven?","Ik kom het infuus controleren (of het nog goed loopt).","U moet in bed blijven.","Als U op de Intensive care ligt bellen de artsen of verpleegkundigen elke dag met uw contactpersoon om te vertellen hoe het gaat.","Ik ga nu het zuurstof kapje over uw neus en mond doen.","Er gebeuren vandaag geen onderzoeken of gesprekken meer.","De COVID-19 test is negatief, dit betekent dat u waarschijnlijk geen Corona heeft.","Soms heeft de test het fout dus we gaan nog meer onderzoek doen.","De COVID-19 test is positief, dit betekent dat u wel Corona heeft.","We gaan in het bloed testen of U antistoffen tegen Corona heeft. Als U antistoffen heeft betekent dit dat U nu Corona heeft of dat U Corona heeft gehad in het verleden.","De Coronatest in het bloed is negatief: u heeft geen antistoffen tegen Corona.","De Coronatest in het bloed is positief: u heeft wel antistoffen tegen Corona.","Met dit recept kunt U medicijnen ophalen bij apotheek.","Met dit recept kan iemand anders medicijnen voor U ophalen bij de apotheek.","Bent U ergens allergisch voor?","Waar bent u allergisch voor?","Gebruikt u medicijnen?","Welke medicijnen gebruikt u?","Kan iemand (thuis) een foto maken van de medicijnen die u gebruikt?"," Rookt u?","Bent U weleens eerder (voor u zelf) in het ziekenhuis geweest?","Welk ziekenhuis was U toen en waarom?","Wanneer was dat?","Zijn er mensen in Uw omgeving ziek?","Welke apotheek komt u?","Wie is uw huisarts?","Wat is uw geboortedatum?","Heeft u speciale dieetwensen? Zoals vegetarisch, veganistisch of bepaalde producten niet?","Heeft U gehoorapparaten of een CI?","Hoe wilt U het liefst communiceren als er geen tolk is? Met liplezen? Zinnen opschrijven? Via deze computer? Of iets anders?","Wilt u toegang tot uw elektronisch dossier? Daarmee kunt u thuis via de computer uitslagen van onderzoeken in zien.","Ik moet naar de wc.","Moet u naar de wc?","Kan ik U helpen?","Ik ga u wassen.","Ik ga u helpen met douchen.","U moet in de douche op de stoel zitten","Wilt u videobellen?","Zal ik u helpen zodat u kunt videobellen?","Dit is de alarmknop, als u hierop drukt dan komt er iemand naar u toe.","Wilt u een tv met teletekst zodat u de ondertiteling kunt aanzetten?","Wat wilt u eten?","Wat wilt u eten, kunt u het aanwijzen op de kaart?","Wat wilt u drinken?","Wat wilt u drinken, kunt u het aanwijzen op de kaart?","Heeft u het warm?","Heeft u het koud?","Het bed gaat nu omhoog.","Het bed gaat nu omlaag.","Wie komt U ophalen?","Ik help U.","Wij helpen U.","Heeft U in de afgelopen 24 uur een van deze klachten gehad: Hoesten, verkoudsheidsklachten, verhoging of koorts, benauwdheid, reuk en/ of smaak verlies?","Heeft U op dit moment een huisgenoot met koorts en/ of benauwdheidsklachten?","Heeft U de afgelopen 7 dagen een Corontest gehad? Zo ja, was deze positief?","Heeft U een huisgenoot/ gezinslid met klachten van het Coronavirus?","Bent U in quarantaine omdat U direct contact heeft gehad met iemand waarbij het nieuwe Coronavirus is vastgesteld? Of heeft U de afgelopen 14 dagen contact gehad met iemand die het Coronavirus heeft?"];

  // Defines the filter that searches the list of options for matches
  function customFilter(array, terms) {
    arrayOfTerms = terms.split(" ");
    punctuation = ["?",",",".",";",":","/"];
    arrayOfTerms.forEach(function (term) {
      if (punctuation.includes(term)) {
        var matcher = new RegExp("\\" + term, "i");
      }
      else{
        var matcher = new RegExp("\\b" + term, "i");
      }
      array = $.grep(array, function (value) {
       return matcher.test(value.label || value.value || value);
      });
    });
    return array;
  }

  // Activates the jquery autocomplete function when the user gives input
  $( "#mySiGML" ).autocomplete({
    source: options,
    appendTo: "#suggestions",
    multiple: true,
    mustMatch: false,
    source: function (request, response) {
        response(customFilter(options, request.term));
    },
  });
});

// Stores the json dictionary of translated sentences as a variable
var json = (function() {
  var json = null;
  $.ajax({
    'async': false,
    'global': false,
    'url': "sentencesDict.json",
    'dataType': "json",
    'success': function(data) {
      json = data;
    }
  });
  return json;
})();

// Checks the dictionary for an entry that matches 'text' and sends the SiGML code to the avatar
function toSiGML(text){
  playText(json[text]);
}


function changeFunc(myRadio) {
  if (myRadio.value == "avatar") {
    document.getElementById("avatar").setAttribute("class", "CWASAAvatar av0");
  }
  else if (myRadio.value == "freestyle") {
    document.getElementById("avatar").setAttribute("class", "CWASAAvatar av0");
  }
  else if (myRadio.value == "video") {
    document.getElementById("avatar").setAttribute("class", "undisplayed");
  }
}

// function goPython(text){
//     $.ajax({
//       method: "POST",
//       url: "main.py",
//       data: JSON.stringify({"param": text}),
//       contentType: "application/json;charset=UTF-8",
//       beforeSend: function() {
//         alert(text);
//       },
//       success: function(response) {
//         playURL(response);
//         alert("It worked " + response);
//       },
//       error: function() {
//         alert('Something went wrong');
//         },
//      });
// }


</script>

<!-- <script type="text/javascript"
    src="https://cdn.jsdelivr.net/npm/brython@3.8.9/brython.min.js">
</script>

<script type="text/javascript"
    src="https://cdn.jsdelivr.net/npm/brython@3.8.9/brython_stdlib.js">
</script> -->

<!-- Necessary for translating python into javascript -->
<!-- <script src="static/brython.js"></script>
<script src="static/brython_stdlib.js"></script> -->


</head>

<!-- <body onload="CWASA.init(); brython(1);"> -->
<!-- <body onload="brython(1);"> -->
<body onload="CWASA.init();">


<!--================================================================-->
<h3>Interface ZonMW COVID-19 Project</h3>

<div align="center">
  <!-- CWA signing avatar panel 0 -->
  <!--================================================================-->
  <!-- <div class="CWASAPanel av0" align="center" ></div> -->
  <span id="avatar" class="CWASAAvatar av0" align="right" ></span>
  <!--================================================================-->

  <span align="left" style="display: inline-block; vertical-align: top;margin:30px;">
  <label for="option">Choose a display option:</label>
  <br>

  <input type="radio" id="avatar" name="display" value="avatar" checked onclick="changeFunc(this);">
  <label for="avatar">Avatar</label><br>
  <input type="radio" id="video" name="display" value="video" onclick="changeFunc(this);">
  <label for="video">Video</label><br>
  <input type="radio" id="freestylu" name="display" value="freestyle" onclick="changeFunc(this);">
  <label for="freestyle">Freestyle with Avatar</label>

    <br>
    <br>
    Enter Sentence:
    <br>
    <span class="ui-widget" id="suggestions">
      <input id="mySiGML" class="txtaSiGMLText" style="margin-top:10px;margin-bottom:10px;">
    </span>

    <br>
    <input type="button" id = "play" value="Translate" onclick='toSiGML(document.getElementById("mySiGML").value);'/>
   <!--  <input type="button" id="play" value="Translate" onclick='playURL("house.sigml");'/> -->
    <input type="button" value="Stop" onclick='CWASA.stopSiGML();' />
    <br>
    <br>
    Adjust speed: <span class="CWASASpeed av0"></span>
    <br>
  </span>

  <!-- <script type="text/python" src="test.py"></script>
  <button id="echo" onclick='suggestions(document.getElementById("mySiGML").value);'>click !</button> -->

  <!-- FR: I've made the following progress fields invisible, if you comment them out completely the avatar doesn't work anymore -->
  <div align="center" class="undisplayed">
    <span style="font-size: 90%;" >
      Sign/Frame:
      <input id="mySF" class="txtSF" value="0/0" type="text" />
      &nbsp;
      Gloss:
      <input id="myGloss" class="txtGloss" value="[none]" type="text" />
      &nbsp;
      FPS:
      <input id="myFPS" class="txtFPS" value="00.00" type="text" />
    </span>
  </div>


  <div align="center">
      <!-- FR: I've made the following status log field invisible, if you comment it out completely the avatar doesn't work anymore -->
      <textarea id="myStatusLog"  class="statusLog undisplayed" rows="6">
      </textarea>
  </div>

  <br>


  <!-- SToCA applet element panel -->
  <!--================================================================-->
  <div class="SToCA" align="center" ></div>
  <!--================================================================-->
</div>
</body>
</html>
